<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>DrivingTrust — Find Your Next Car</title>

<style>
  :root {
    --primary: #003a75;
    --secondary: #1c5db5;
    --bg: #f5f7fa;
    --text-main: #1f2937;
    --text-light: #6b7280;
    --shadow: 0 6px 20px rgba(0,0,0,0.08);
    --radius: 12px;
  }

  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: var(--bg);
    color: var(--text-main);
  }

  /* NAVBAR */
  .navbar {
    background: white;
    padding: 16px 26px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: var(--shadow);
    position: sticky;
    top: 0;
    z-index: 20;
  }
  .nav-left {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 22px;
    font-weight: bold;
    color: var(--primary);
  }
  .nav-right a {
    margin-left: 20px;
    font-weight: 600;
    color: var(--primary);
    text-decoration: none;
  }
  .nav-right a:hover {
    text-decoration: underline;
  }

  /* HERO */
  .hero {
    background: white;
    padding: 50px 20px 70px;
    text-align: center;
    box-shadow: var(--shadow);
  }
  .hero h1 {
    font-size: 38px;
    margin-bottom: 10px;
    color: var(--primary);
  }
  .hero p {
    font-size: 18px;
    color: var(--text-light);
  }

  /* SEARCH BAR */
  .search-box {
    max-width: 800px;
    margin: 30px auto 0;
    display: flex;
    gap: 10px;
    background: #ffffff;
    padding: 18px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }
  .search-box input, .search-box select {
    flex: 1;
    padding: 14px;
    border: 1px solid #d1d5db;
    border-radius: var(--radius);
    font-size: 14px;
  }
  .search-btn {
    background: var(--primary);
    color: white;
    padding: 14px 24px;
    border: none;
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
  }
  .search-btn:hover {
    background: #00468f;
  }

  /* BRAND ICON GRID */
  .brands {
    max-width: 900px;
    margin: 40px auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    text-align: center;
    gap: 20px;
  }
  .brand-item {
    background: white;
    padding: 20px;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
  }
  .brand-item:hover {
    background: #eef5ff;
  }

  /* LISTINGS */
  .section-title {
    max-width: 1100px;
    margin: 40px auto 10px;
    font-size: 24px;
    font-weight: bold;
  }
  .car-grid {
    max-width: 1100px;
    margin: auto;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 22px;
    padding-bottom: 50px;
  }
  .car-card {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden;
    cursor: pointer;
    transition: 0.2s;
  }
  .car-card:hover {
    transform: translateY(-4px);
  }
  .car-thumb {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }
  .car-info {
    padding: 16px;
  }
  .car-info h3 {
    margin: 0;
    font-size: 18px;
    color: var(--primary);
  }
  .car-info .row {
    margin-top: 6px;
    color: var(--text-light);
  }
  .price {
    margin-top: 10px;
    font-size: 20px;
    color: #059669;
    font-weight: bold;
  }
</style>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar">
  <div class="nav-left">DrivingTrust</div>
  <div class="nav-right">
    <a href="/">Browse Cars</a>
    <a href="/sell.html">Sell My Car</a>
    <a href="/admin">Admin</a>
  </div>
</div>

<!-- HERO -->
<div class="hero">
  <h1>Find Your Next Car</h1>
  <p>The safest C2C platform in Canada</p>

  <!-- SEARCH -->
  <div class="search-box">
    <input id="search-input" type="text" placeholder="Search by brand, model, city, seller..." />
    <select id="city-select">
      <option value="all">All Cities</option>
      <option>Richmond</option>
      <option>Vancouver</option>
      <option>Burnaby</option>
      <option>Surrey</option>
    </select>
    <select id="price-select">
      <option value="all">Any Price</option>
      <option value="20000">Below 20k</option>
      <option value="30000">Below 30k</option>
      <option value="40000">Below 40k</option>
      <option value="50000">Below 50k</option>
    </select>

    <button class="search-btn" onclick="applySearch()">Search</button>
  </div>
</div>

<!-- POPULAR BRANDS -->
<h2 class="section-title">Popular Brands</h2>
<div class="brands">
  <div class="brand-item" onclick="filterBrand('Toyota')">Toyota</div>
  <div class="brand-item" onclick="filterBrand('Honda')">Honda</div>
  <div class="brand-item" onclick="filterBrand('BMW')">BMW</div>
  <div class="brand-item" onclick="filterBrand('Mercedes')">Mercedes</div>
  <div class="brand-item" onclick="filterBrand('Audi')">Audi</div>
  <div class="brand-item" onclick="filterBrand('Lexus')">Lexus</div>
</div>

<!-- LATEST LISTINGS -->
<h2 class="section-title">Latest Listings</h2>
<div id="car-list" class="car-grid"></div>


<script>
// 载入车辆
let ALL_CARS = [];

async function loadCars() {
  const res = await fetch("/api/getCars");
  ALL_CARS = await res.json();
  renderCars(ALL_CARS);
}

function renderCars(list) {
  const container = document.getElementById("car-list");
  container.innerHTML = "";

  list.forEach(car => {
    const img = car.images?.[0] || "https://placehold.co/600x400?text=No+Image";

    const card = document.createElement("div");
    card.className = "car-card";
    card.onclick = () => window.location.href = "/car.html?id=" + car.id;

    card.innerHTML = `
      <img class="car-thumb" src="${img}">
      <div class="car-info">
        <h3>${car.car}</h3>
        <div class="row">City: ${car.city}</div>
        <div class="row">Mileage: ${car.mileage} km</div>
        <div class="row">Seller: ${car.name}</div>
        <div class="price">$${car.price}</div>
      </div>
    `;

    container.appendChild(card);
  });
}

function applySearch() {
  const keyword = document.getElementById("search-input").value.toLowerCase();
  const city = document.getElementById("city-select").value;
  const maxPrice = document.getElementById("price-select").value;

  let filtered = ALL_CARS.filter(car => {
    const matchKeyword =
      car.car.toLowerCase().includes(keyword) ||
      car.city.toLowerCase().includes(keyword) ||
      car.name.toLowerCase().includes(keyword);

    const matchCity = (city === "all") || (car.city === city);

    const matchPrice =
      maxPrice === "all" || Number(car.price) <= Number(maxPrice);

    return matchKeyword && matchCity && matchPrice;
  });

  renderCars(filtered);
}

function filterBrand(brand) {
  const filtered = ALL_CARS.filter(car =>
    car.car.toLowerCase().includes(brand.toLowerCase())
  );
  renderCars(filtered);
}

loadCars();
</script>

</body>
</html>
